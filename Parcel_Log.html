<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç£ç²¾éŠ³åŒ…è£¹ç™»è¨˜å¹³å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f3f4f6; font-family: sans-serif; }
        .form-container { background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-top: 4px solid #d32f2f; }
        input, select { border: 1px solid #ccc !important; border-radius: 4px !important; padding: 8px !important; width: 100%; }
        .btn-submit { background-color: #d32f2f; color: white; transition: background 0.3s; }
        .btn-submit:hover { background-color: #b71c1c; }
    </style>
</head>
<body class="p-4 flex items-center justify-center min-h-screen">
    <div class="form-container w-full max-w-2xl p-8">
        <h1 class="text-center text-xl font-bold mb-8 tracking-widest">å°ç£ç²¾éŠ³åŒ…è£¹ç™»è¨˜å¹³å°</h1>
        
        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="text-xs text-gray-500">å–®ä½åç¨± (å¦‚ï¼šæ¥­å‹™éƒ¨)</label>
                <input type="text" id="dept" placeholder="å–®ä½åç¨±">
            </div>
            <div>
                <label class="text-xs text-gray-500">æ”¶ä»¶äººå§“å</label>
                <input type="text" id="receiver" placeholder="æ”¶ä»¶äººå§“å">
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
                <label class="text-xs text-gray-500">åŒäº‹çš„ Email (å¿…å¡«)</label>
                <input type="email" id="email" placeholder="Email">
            </div>
            <div>
                <label class="text-xs text-gray-500">åŒ…è£¹é¡å‹</label>
                <select id="type">
                    <option value="ğŸ“¦ ä¸€èˆ¬åŒ…è£¹">ğŸ“¦ ä¸€èˆ¬åŒ…è£¹</option>
                    <option value="âœ‰ï¸ æ›è™Ÿä¿¡ä»¶">âœ‰ï¸ æ›è™Ÿä¿¡ä»¶</option>
                    <option value="ğŸ• å¤–é€/ç¾é£Ÿ">ğŸ• å¤–é€/ç¾é£Ÿ</option>
                    <option value="âš ï¸ é‡è¦æ€¥ä»¶">âš ï¸ é‡è¦æ€¥ä»¶</option>
                </select>
            </div>
        </div>

        <div class="mb-4">
            <label class="text-xs text-gray-500">ç‰©æµå…¬å¸ (å¦‚ï¼šé»‘è²“)</label>
            <input type="text" id="courier" placeholder="ç‰©æµå…¬å¸">
        </div>

        <div class="mb-6">
            <label class="text-xs text-gray-500">å‚™è¨» (å¦‚ï¼šä»£ä»˜100å…ƒ)</label>
            <input type="text" id="note" placeholder="å‚™è¨»å…§å®¹">
        </div>

        <button onclick="sendParcel()" id="saveBtn" class="w-full py-3 btn-submit rounded font-bold flex items-center justify-center gap-2">
            <span>â• ç™»è¨˜ä¸¦åŠ å…¥æ¸…å–®</span>
        </button>

        <div class="mt-8 border-t pt-4">
            <input type="text" placeholder="ğŸ” å¿«é€Ÿæœå°‹..." class="text-sm">
        </div>
    </div>

    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxm4CDB5i8V2CX6lbCu4gxI2TH-jGKFznI8H01CLlnKEh9Fdr71pfeQr7ai6VcVtAvomw/exec";

        async function sendParcel() {
            const btn = document.getElementById('saveBtn');
            const data = {
                type: 'parcel',
                dept: document.getElementById('dept').value,
                receiver: document.getElementById('receiver').value,
                email: document.getElementById('email').value,
                pType: document.getElementById('type').value,
                courier: document.getElementById('courier').value,
                note: document.getElementById('note').value
            };

            if(!data.receiver || !data.courier) { alert("è«‹å¡«å¯«æ”¶ä»¶äººèˆ‡ç‰©æµå…¬å¸ï¼"); return; }

            btn.disabled = true;
            btn.innerHTML = "å‚³è¼¸ä¸­...";

            try {
                await fetch(`${SCRIPT_URL}?type=parcel&courier=${encodeURIComponent(data.courier)}&receiver=${encodeURIComponent(data.receiver)}&dept=${encodeURIComponent(data.dept)}&note=${encodeURIComponent(data.note)}&pType=${encodeURIComponent(data.pType)}`, { mode: 'no-cors' });
                alert(`âœ… ç™»è¨˜æˆåŠŸï¼\nå·²å°‡ ${data.receiver} çš„åŒ…è£¹ç´€éŒ„è‡³é›²ç«¯ã€‚`);
                location.reload(); 
            } catch (e) {
                alert("é€£ç·šå¤±æ•—ï¼");
                btn.disabled = false;
                btn.innerHTML = "<span>â• ç™»è¨˜ä¸¦åŠ å…¥æ¸…å–®</span>";
            }
        }
    </script>
</body>
</html>
