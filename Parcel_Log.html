<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ç£ç²¾éŠ³ | é›²ç«¯åŒ…è£¹ç™»è¨˜ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #0f172a; color: white; }
        .log-card { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="p-4">
    <header class="text-center mb-6">
        <h1 class="text-3xl font-black text-yellow-500 italic">åŒ…è£¹è‡ªå‹•ç™»è¨˜</h1>
        <p class="text-[10px] text-slate-500 tracking-widest uppercase">Cloud Sync System</p>
    </header>

    <div class="max-w-md mx-auto space-y-4">
        <section class="log-card p-4 rounded-2xl border border-slate-700">
            <label class="block text-xs font-bold text-slate-400 mb-2">ç‰©æµå…¬å¸ / è²¨é‹åç¨±</label>
            <select id="courier" class="w-full p-3 bg-slate-800 rounded-xl text-xl font-bold outline-none border-2 border-transparent focus:border-yellow-500">
                <option value="é»‘è²“å®…æ€¥ä¾¿">é»‘è²“å®…æ€¥ä¾¿</option>
                <option value="æ–°ç«¹ç‰©æµ">æ–°ç«¹ç‰©æµ</option>
                <option value="å˜‰é‡Œå¤§æ¦®">å˜‰é‡Œå¤§æ¦®</option>
                <option value="éƒµå±€">ä¸­è¯éƒµæ”¿</option>
                <option value="å¤–é€ (Foodpanda/Uber)">å¤–é€å¹³å°</option>
                <option value="å…¶ä»–">å…¶ä»– (è«‹è‡ªè¡Œå‚™è¨»)</option>
            </select>
        </section>

        <section class="log-card p-4 rounded-2xl border border-slate-700">
            <label class="block text-xs font-bold text-slate-400 mb-2">æ”¶ä»¶äººå§“å (æˆ–å–®ä½)</label>
            <input type="text" id="receiver" placeholder="ä¾‹å¦‚ï¼šç­é•· / è¾¦å…¬å®¤" class="w-full p-3 bg-slate-800 rounded-xl text-xl font-bold outline-none border-2 border-transparent focus:border-yellow-500">
        </section>

        <button onclick="uploadParcel()" id="saveBtn" class="w-full py-5 bg-yellow-600 rounded-2xl text-2xl font-black shadow-[0_6px_0_#854d0e] active:shadow-none active:translate-y-1">
            ç¢ºèªç™»è¨˜ä¸¦åŒæ­¥é›²ç«¯
        </button>

        <p class="text-center text-[10px] text-slate-500 mt-4">â€» ç™»è¨˜å¾Œè³‡æ–™å°‡è‡ªå‹•å½™æ•´è‡³æŒ‡æ®éƒ¨å¾Œå°</p>
    </div>

    <script>
        async function uploadParcel() {
            const courier = document.getElementById('courier').value;
            const receiver = document.getElementById('receiver').value;
            const btn = document.getElementById('saveBtn');

            if(!receiver) { alert('è«‹è¼¸å…¥æ”¶ä»¶äººï¼'); return; }

            btn.disabled = true;
            btn.innerText = "æ­£åœ¨å‚³è¼¸...";
            btn.classList.add('opacity-50');

            // å¦³å‰›å‰›çµ¦æˆ‘çš„æ–°ç¶²å€
            const scriptUrl = "https://script.google.com/macros/s/AKfycbx1H2w_DCZaOOFvRUK86A6jbAWxAwvXO5LxhFYNDT43XoLIbi0Dsh2mpAj2F5zhfPFqRw/exec";
            
            try {
                // ä½¿ç”¨ type=parcel å‘Šè¨´å¾Œå°é€™æ˜¯åŒ…è£¹è³‡æ–™
                await fetch(`${scriptUrl}?type=parcel&courier=${encodeURIComponent(courier)}&receiver=${encodeURIComponent(receiver)}`, { mode: 'no-cors' });
                
                alert('ğŸ“¦ ç™»è¨˜æˆåŠŸï¼è³‡æ–™å·²åŒæ­¥è‡³å¾Œå°ã€‚');
                document.getElementById('receiver').value = ''; // æ¸…ç©ºè¼¸å…¥æ¡†
                btn.innerText = "ç¢ºèªç™»è¨˜ä¸¦åŒæ­¥é›²ç«¯";
                btn.disabled = false;
                btn.classList.remove('opacity-50');
            } catch (error) {
                alert('é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯ï¼');
                btn.innerText = "é‡è©¦ä¸€æ¬¡";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
